import re
import sys

# 簡繁對照表 - 常用字詞
CONVERSION_MAP = {
    # 常用詞彙
    '访问': '訪問', '拒绝': '拒絕', '删除': '刪除', '创建': '建立', '编辑': '編輯',
    '设置': '設定', '输入': '輸入', '用户': '使用者', '邮件': '郵件', '电子邮件': '電子郵件',
    '网络': '網路', '错误': '錯誤', '账户': '帳戶', '密钥': '金鑰', '链接': '連結',
    '验证': '驗證', '注册': '註冊', '登录': '登入', '注销': '登出', '确认': '確認',
    '选择': '選擇', '搜索': '搜尋', '查询': '查詢', '下载': '下載', '上传': '上傳',
    '图片': '圖片', '图像': '圖像', '视频': '影片', '文件': '檔案', '相册': '相簿',
    '画廊': '圖庫', '盖尔': '圖庫', '密码': '密碼', '配置': '設定檔', '审计': '稽核',
    '审查': '審查', '核准': '核准', '驳回': '駁回', '饼干': 'Cookie', '发送': '傳送',
    '获取': '取得', '导出': '匯出', '导入': '匯入', '备份': '備份', '重设': '重設',
    '重置': '重設', '激活': '啟用', '冻结': '凍結', '解冻': '解凍', '更新': '更新',
    '成功': '成功', '失败': '失敗', '警告': '警告', '信息': '資訊', '日志': '日誌',
    '限制': '限制', '数据': '資料', '资源': '資源', '自定义': '自訂', '临时': '暫存',
    '背景': '背景', '扫描器': '掃描器', '报告': '報告', '统计': '統計', '清理': '清理',
    '过滤器': '篩選器', '随机': '隨機', '列报': '簡報', '外观': '肖像', '风景': '風景',
    '无效': '無效', '复制': '複製', '检测': '偵測', '单击': '點選', '拖动': '拖曳',
    '关闭': '關閉', '保存': '儲存', '联系': '聯絡', '管理员': '管理員', '帐户': '帳戶',
    '宝石': '寶石', '权限': '權限', '默认': '預設', '危险': '危險', '破坏': '破壞',
    '执行': '執行', '屏蔽': '封鎖', '锁定': '鎖定', '分钟': '分鐘', '尝试': '嘗試',
    '启用': '啟用', '需要': '需要', '警报': '警示', '服务': '服務', '目录': '目錄',
    '页': '頁', '演示': '示範', '板块': '板塊', '定期': '定期', '擦去': '清除',
    '擦拭': '清除', '干净': '乾淨', '确定': '確定', '欢迎': '歡迎', '光临': '光臨',
    '请': '請', '指定': '指定', '之间': '之間', '包含': '包含', '大写': '大寫',
    '小写': '小寫', '字符': '字元', '特殊': '特殊', '容易': '容易', '猜到': '猜到',
    '安全': '安全', '新': '新', '問题': '問題', '问题': '問題', '处理': '處理',
    '等待': '等待', '待决': '待決', '待上传': '待上傳', '待审': '待審', '待审查': '待審查',
    '核定数': '已核准', '登记册': '註冊', '发布': '發布', '版本': '版本',
    '重命名': '重新命名', '已执行': '已執行', '进行': '進行', '发出': '發出',
    '时': '時', '应': '應', '如果': '如果', '有': '有', '新项目': '新項目',
    '有待': '有待', '应发出': '應發出', '屏蔽前': '封鎖前', '次数': '次數',
    '应该': '應該', '被屏蔽': '被封鎖', '多久': '多久', '出现': '出現',
    '页眉': '頁首', '是否': '是否', '允许': '允許', '客人': '來賓', '激活其': '啟用其',
    '被锁定': '被鎖定', '提供': '提供', '令牌': '權杖', '类型': '類型',
    '编号': '編號', '请求': '請求', '使用': '使用', '键': '鍵', '手机': '手機',
    '扫描': '掃描', '代码': '代碼', '共享': '分享', '目前': '目前', '没有': '沒有',
    '记忆': '記憶', '为什么': '為什麼', '不': '不', '你': '你', '已满': '已滿',
    '超过': '超過', '最大': '最大', '大小': '大小', '标识符': '識別碼',
    '标识': '識別碼', '我的': '我的', '婚礼': '婚禮', '彩礼': '禮金',
    '在此': '在此', '已经': '已經', '达到': '達到', '数量': '數量',
    '未找到': '未找到', '不存在': '不存在', '上你的': '上你的', '并': '並',
    '名称': '名稱', '不能': '不能', '空': '空', '媒体': '媒體',
    '成员': '成員', '生成': '產生', '组': '群組', '装入': '載入', '主页': '首頁',
    '出错': '發生錯誤', '身份': '身分', '会话': '工作階段', '最大文件': '最大檔案',
    '媒体类型': '媒體類型', '正确': '正確', '要素': '要素', '符号': '符號',
    '期限': '期間', '基于': '基於', '名词': '名詞', '所有': '所有',
    '把': '把', '都': '都', '了': '了', '可用': '可用', '状态': '狀態',
    '要': '要', '这个': '這個', '吗': '嗎', '此处': '此處', '站': '站',
    '策略': '策略', '通过': '透過', '这个网站': '這個網站', '同意': '同意',
    '我们': '我們', '根据': '根據', '条件': '條件', '知道': '知道', '更多': '更多',
    '看我们': '看我們', '您': '您', '无法': '無法', '将': '將', '文件夹': '資料夾',
    '一个': '一個', '是': '是', '版': '版', '被': '被', '以确保': '以確保',
    '未来': '未來', '测试者': '測試者', '有一个': '有一個', '降级': '降序',
    '行动': '操作', '您无权': '您無權', '同名': '同名', '已经存在': '已經存在',
    '忘记': '忘記', '地址': '位址', '无': '無', '您的': '您的', '现已': '現已',
    '如果您没有': '如果您沒有', '立即': '立即', '已': '已', '账号': '帳號',
    '访问你的': '存取你的', '有问题吗': '有問題嗎', '发送': '傳送',
    '向': '向', '新用户': '新使用者', '一个有效的': '一個有效的',
    '到': '到', '个字符': '個字元', '其中': '其中', '至少': '至少',
    '一个': '一個', '和': '和', '另一': '另一', '有一个问题': '有一個問題',
    '已成功': '已成功', '并': '並', '等待您': '等待您', '欢迎光临': '歡迎光臨',
    '已经注册': '已經註冊', '但': '但', '核实': '核實', '才能': '才能',
    '点击': '點選', '以下': '以下', '账户': '帳戶', '已存在': '已存在',
    '一个新的': '一個新的', '很': '很', '个': '個', '更': '更',
    '挂': '掛', '當': '當', '時': '時', '屏': '封', '鎖': '鎖',
    '啟': '啟', '訪': '存取', '發': '發', '傳': '傳', '網': '網',
    '從': '從', '為': '為', '與': '與', '對': '對', '於': '於',
    '會': '會', '個': '個', '這': '這', '當': '當', '來': '來',
    '執': '執', '處': '處', '學': '學', '關': '關', '開': '開',
    '進': '進', '運': '運', '過': '過', '還': '還', '連': '連',
    '選': '選', '變': '變', '體': '體', '現': '現', '產': '產',
    '確': '確', '認': '認', '辦': '辦', '識': '識', '該': '該',
    '說': '說', '請': '請', '調': '調', '課': '課', '論': '論',
    '護': '護', '導': '導', '準': '準', '預': '預', '獲': '獲',
    '種': '種', '條': '條', '備': '備', '復': '復', '測': '測',
    '檢': '檢', '標': '標', '構': '構', '層': '層', '質': '質',
    '類': '類', '統': '統', '級': '級', '組': '組', '結': '結',
    '給': '給', '絡': '絡', '繼': '繼', '維': '維', '總': '總',
    '織': '織', '線': '線', '練': '練', '縮': '縮', '績': '績',
    '編': '編', '錄': '錄', '錯': '錯', '鍵': '鍵', '鎖': '鎖',
    '關鍵': '關鍵', '開關': '開關', '國': '國', '園': '園', '圖': '圖',
    '團': '團', '壓': '壓', '壞': '壞', '聲': '聲', '賣': '賣',
    '貫': '貫', '費': '費', '資': '資', '賬': '帳', '購': '購',
    '貨': '貨', '質': '質', '贊': '讚', '賓': '賓', '贈': '贈',
    '趨': '趨', '轉': '轉', '輕': '輕', '較': '較', '載': '載',
    '輛': '輛', '輯': '輯', '輪': '輪', '軟': '軟', '轉換': '轉換',
    '辦': '辦', '農': '農', '達': '達', '違': '違', '運': '運',
    '進': '進', '遠': '遠', '適': '適', '選': '選', '遞': '遞',
    '還': '還', '邊': '邊', '郵': '郵', '際': '際', '險': '險',
    '隨': '隨', '際關': '際關', '隱': '隱', '雜': '雜', '難': '難',
    '電': '電', '需': '需', '霧': '霧', '靈': '靈', '靜': '靜',
    '頁': '頁', '頂': '頂', '項': '項', '順': '順', '頭': '頭',
    '頻': '頻', '題': '題', '額': '額', '顧': '顧', '顯': '顯',
    '風': '風', '飛': '飛', '飯': '飯', '飾': '飾', '養': '養',
    '餘': '餘', '館': '館', '餐': '餐', '駁': '駁', '騙': '騙',
    '騰': '騰', '驗': '驗', '體': '體', '高': '高', '髮': '髮',
    '鬥': '鬥', '魯': '魯', '鳥': '鳥', '鹽': '鹽', '鹿': '鹿',
    '麗': '麗', '麥': '麥', '黃': '黃', '黑': '黑', '默': '默',
    '黨': '黨', '鼓': '鼓', '鼠': '鼠', '鼻': '鼻', '齊': '齊',
    '齒': '齒', '齡': '齡', '龍': '龍', '龜': '龜',
    # 額外詞彙
    'Opps 似乎发生了出乎意料的错误': 'Opps 似乎發生了出乎意料的錯誤',
    '看来你无权查看那页': '看來你無權查看那頁',
    '看来': '看來', '那页': '那頁', '持续存在': '持續存在',
    'Froze 用户': '凍結使用者', '擦了': '清除了',
    '无数据': '無資料', '尚未创建画廊': '尚未建立圖庫',
    '在审查前没有上传': '審查前沒有上傳',
}

def convert_simplified_to_traditional(text):
    """將簡體中文轉換為繁體中文"""
    # 先處理多字詞
    sorted_terms = sorted(CONVERSION_MAP.items(), key=lambda x: len(x[0]), reverse=True)
    
    for simplified, traditional in sorted_terms:
        text = text.replace(simplified, traditional)
    
    return text

def process_resx_file(input_file, output_file):
    """處理 .resx 檔案"""
    try:
        with open(input_file, 'r', encoding='utf-8') as f:
            content = f.read()
        
        # 使用正則表達式找到所有的 <value> 標籤
        def replace_value(match):
            original = match.group(1)
            converted = convert_simplified_to_traditional(original)
            return f'<value>{converted}</value>'
        
        # 轉換所有 <value>...</value> 中的內容
        content = re.sub(r'<value>(.*?)</value>', replace_value, content, flags=re.DOTALL)
        
        with open(output_file, 'w', encoding='utf-8') as f:
            f.write(content)
        
        print(f"✓ 轉換完成: {output_file}")
        return True
    except Exception as e:
        print(f"✗ 轉換失敗: {input_file}")
        print(f"  錯誤: {str(e)}")
        return False

if __name__ == "__main__":
    import os
    
    # 資源檔案路徑
    base_path = r"WeddingShare\Resources\Lang"
    
    # 需要轉換的檔案列表
    files_to_convert = [
        "Translations.zh-Hans.resx",
        "Translations.zh-Hans-CN.resx",
        "Translations.zh-Hans-HK.resx",
        "Translations.zh-Hans-MO.resx",
        "Translations.zh-Hans-SG.resx",
    ]
    
    print("開始轉換簡體中文為繁體中文...\n")
    
    success_count = 0
    for filename in files_to_convert:
        file_path = os.path.join(base_path, filename)
        if process_resx_file(file_path, file_path):
            success_count += 1
    
    print(f"\n轉換完成！成功: {success_count}/{len(files_to_convert)}")
